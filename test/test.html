<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
     <script src="../dist/zreact.devtools.js"></script>
    <title>Document</title>
</head>
<body>
    <div id="app">
    </div>
    <script>
        if (typeof preact !== "undefined")
            var zreact = preact;

        class Foo extends zreact.Component {
            constructor(props, context) {
                super(props, context)
                this.state = {
                    num: [1,2,3]
                }
            }
            render(props, state) {
                var self = this
                var test = state.num.map(function(i, index) {
                    return zreact.h("li", null, i, zreact.h("button", { onClick: self["delete"].bind(self, index) }, "x"))
                });
                return zreact.h("div", null, zreact.h("ul", null, test), zreact.h("button", { onClick: this.test.bind(this) }, "添加"));
            }
            test() {
                console.log("Foo test", this.state);
                this.setState(function(state) {
                    state.num.push(state.num.length + 1);
                })
            }
            "delete"(index) {
                this.setState(function(state) {
                    state.num.splice(index, 1);
                })
            }
        }
        var scratch = document.querySelector("#app");
        zreact.render(zreact.h(Foo), scratch)
    </script>
     <!-- <script src="../dist/devtools.js"></script> -->
    <!-- <script src="../node_modules/preact/devtools.js"></script> -->
</body>
</html>
