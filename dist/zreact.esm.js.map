{"version":3,"file":"zreact.esm.js","sources":["../src/options.ts","../src/vnode.ts","../src/h.ts","../src/util.ts","../src/clone-element.ts","../src/constants.ts","../src/render-queue.ts","../src/vdom/component-recycler.ts","../src/dom/index.ts","../src/vdom/index.ts","../src/vdom/diff.ts","../src/vdom/component.ts","../src/component.ts","../src/pure-component.ts","../src/render.ts","../src/create-class.ts","../src/zreact.ts"],"sourcesContent":["import { VNode } from \"./vnode\";\nimport { Component } from \"component\";\n\nconst options: {\n    afterUpdate?: (component: Component) => void;\n    beforeUnmount?: (component: Component) => void;\n    afterMount?: (component: Component) => void;\n    syncComponentUpdates?: boolean;\n    debounceRendering?: (render: () => void) => void;\n    vnode?: (vnode: VNode) => void;\n    event?: (event: Event) => any;\n    // 是否自动对事件方法绑定this为组件，默认为true(preact没有)\n    eventBind?: boolean;\n} = {\n    eventBind: true,\n};\n\nexport default options;\n","import { Component } from \"./component\";\n\nexport class VNode {\n    public nodeName: string| Component;\n    public children: any[];\n    public attributes: any | undefined;\n    public key: any | undefined;\n}\n","import { Component } from \"./component\";\nimport options from \"./options\";\nimport { VNode } from \"./vnode\";\n\n// const EMPTY_CHILDREN: any[] = [];\n\n/** JSX/hyperscript reviver\n * Benchmarks: https://esbench.com/bench/57ee8f8e330ab09900a1a1a0\n * 标准JSX转换函数\n * @param {string|Component} nodeName 组件{@link Component}或者原生dom组件名\n * @param {{key: string => value: string}} attributes 组件属性\n * @see http://jasonformat.com/wtf-is-jsx\n * @public\n */\nexport function h(nodeName: string | Component, attributes: any, ...args: any[]) {\n    // 初始化子元素列表\n    const stack: any[] = [];\n    const children: any[] = [];\n    // let i: number;\n    // let child: any;\n    // 是否为原生组件\n    let simple: boolean;\n    // 上一个子元素是否为原生组件\n    let lastSimple: boolean = false;\n    // 把剩余的函数参数全部倒序放入stack\n    for (let i = args.length; i--; ) {\n        stack.push(args[i]);\n    }\n    // 把元素上属性的children放入栈\n    if (attributes && attributes.children != null) {\n        if (!stack.length) {\n            stack.push(attributes.children);\n        }\n        // 删除\n        delete attributes.children;\n    }\n    // 把stack一次一次取出\n    while (stack.length) {\n        // 取出最后一个\n        let child: any = stack.pop();\n        if (child && child.pop !== undefined) {\n            // 如果是个数组就倒序放入stack\n            for (let i = child.length; i-- ; ) {\n                stack.push(child[i]);\n            }\n        } else {\n            // 清空布尔\n            if (typeof child === \"boolean\") {\n                child = null;\n            }\n            // 判断当前组件是否为自定义组件\n            simple = typeof nodeName !== \"function\";\n            if (simple) {\n                // 原生组件的子元素处理\n                if (child == null) {\n                    // null to \"\"\n                    child = \"\";\n                } else if (typeof child === \"number\") {\n                    // num to string\n                    child = String(child);\n                } else if (typeof child !== \"string\") {\n                    // 不是 null,number,string 的不做处理\n                    // 并且设置标记不是一个字符串\n                    simple = false;\n                }\n            }\n            if (simple && lastSimple) {\n                // 当前为原生组件且子元素为字符串，并且上一个也是。\n                // 就把当前子元素加到上一次的后面。\n                children[children.length - 1] += child;\n            } else {\n                // 其它情况直接加入children\n                children.push(child);\n            }\n            /* else if (children === EMPTY_CHILDREN) {\n                children = [child];\n            } */\n            // 记录这次的子元素状态\n            lastSimple = simple;\n        }\n    }\n    const p = new VNode();\n    // 设置原生组件名字或自定义组件class(function)\n    p.nodeName = nodeName;\n    // 设置子元素\n    p.children = children;\n    // 设置属性\n    p.attributes = attributes == null ? undefined : attributes;\n    // 设置key\n    p.key = attributes == null ? undefined : attributes.key;\n    // vnode 钩子\n    if (options.vnode !== undefined) {\n        options.vnode(p);\n    }\n    return p;\n}\n","declare const Promise: any;\ndeclare class Object {\n    public static assign: (...args: any[]) => any;\n}\n\nexport let defer: (fn: () => void) => void;\nif (typeof Promise === \"function\") {\n    const promiseDefer = Promise.resolve();\n    defer = (fn: () => void) => promiseDefer.then(fn);\n} else {\n    defer = setTimeout;\n}\n\nexport const extend = Object.assign || function assign_(t: any) {\n    for (let s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (const p in s) {\n            if (Object.prototype.hasOwnProperty.call(s, p)) {\n                t[p] = s[p];\n            }\n        }\n    }\n    return t;\n};\n","import { h } from \"./h\";\nimport { VNode } from \"./vnode\";\nimport { extend } from \"./util\";\n\nexport function cloneElement(vnode: VNode, props: any, ...children: any[]) {\n    return h(\n        vnode.nodeName,\n        extend({}, vnode.attributes, props),\n        children.length > 2 ? children : vnode.children,\n    );\n}\n","// 不进行render\nexport const NO_RENDER = 0;\n// 同步render标记\nexport const SYNC_RENDER = 1;\n// 用于Component.forceUpdate方法更新组件时的标记\nexport const FORCE_RENDER = 2;\n// 异步render标记\nexport const ASYNC_RENDER = 3;\n\nexport const ATTR_KEY = \"__preactattr_\";\n\n// 使用number值的style属性\nexport const IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i;\n","import { Component } from \"./component\";\nimport options from \"./options\";\nimport { defer } from \"./util\";\nimport { renderComponent } from \"./vdom/component\";\n\nlet items: Component[] = [];\n\nexport function enqueueRender(component: Component) {\n    if (!component._dirty) {\n        component._dirty = true;\n        const len = items.push(component);\n        if (len === 1) {\n            const deferFun = options.debounceRendering || defer;\n            deferFun(rerender);\n        }\n    }\n}\n\nexport function rerender() {\n    let p: Component | undefined;\n    const list = items;\n    items = [];\n    p = list.pop();\n    while (p) {\n        if (p._dirty) {\n            renderComponent(p);\n        }\n        p = list.pop();\n    }\n}\n","import { Component } from \"../component\";\n\nconst components: {\n    [name: string]: Component[];\n} = {};\n\nexport function collectComponent(component: Component) {\n    const constructor: any = component.constructor;\n    const name = constructor.name;\n    const list = components[name] || [];\n    list.push(component);\n}\n\nexport function createComponent(Ctor: any, props: any, context: any) {\n    const list = components[Ctor.name];\n    let inst: Component;\n    if (Ctor.prototype && Ctor.prototype.render) {\n        inst = new Ctor(props, context);\n        Component.call(inst, props, context);\n    } else {\n        inst = new Component(props, context);\n        inst.constructor = Ctor;\n        inst.render = doRender;\n    }\n    if (list) {\n        for (let i = list.length; i-- ; ) {\n            const item = list[i];\n            if (item.constructor === Ctor) {\n                inst.nextBase = item.nextBase;\n                list.splice(i, 1);\n                break;\n            }\n        }\n    }\n    return inst;\n}\n\nfunction doRender(props: any, state: any, tcontext: any) {\n    return this.constructor(props, tcontext);\n}\n","import { IS_NON_DIMENSIONAL } from \"../constants\";\nimport options from \"../options\";\n\nexport function createNode(nodeName: string, isSvg: boolean): HTMLElement {\n    const node: any = isSvg\n        ? document.createElementNS(\"http://www.w3.org/2000/svg\", nodeName)\n        : document.createElement(nodeName);\n    node.normalizedNodeName = nodeName;\n    return node;\n}\n\nexport function removeNode(node: HTMLElement) {\n    const parentNode = node.parentNode;\n    if (parentNode) {\n        parentNode.removeChild(node);\n    }\n}\n\nexport function setAccessor(\n    node: any,\n    name: string,\n    old: any,\n    value: any,\n    isSvg: boolean,\n    child: any,\n) {\n    if (name === \"className\") {\n        name = \"class\";\n    }\n    if (name === \"key\") {\n        // no set\n    } else if (\"ref\" === name) {\n        if (old) {\n            old(null);\n        }\n        if (value) {\n            value(node);\n        }\n    } else if (\"class\" === name && !isSvg) {\n        node.className = value || \"\";\n    } else if (\"style\" === name) {\n        if (!value || typeof value === \"string\" || typeof old === \"string\") {\n            node.style.cssText = value || \"\";\n        }\n        if (value && typeof value === \"object\") {\n            if (typeof old !== \"string\") {\n                for (const i in old) {\n                    if (!(i in value)) {\n                        node.style[i] = \"\";\n                    }\n                }\n            }\n            for (const i in value) {\n                node.style[i] = typeof value[i] === \"number\"\n                && IS_NON_DIMENSIONAL.test(i) === false ? (value[i] + \"px\") : value[i];\n            }\n        }\n    } else if (\"dangerouslySetInnerHTML\" === name) {\n        if (value) {\n            node.innerHTML = value.__html || \"\";\n            // child.children = [];\n            // const childNodes = node.childNodes;\n            // for (let i = 0, len = childNodes.length; i < len ; i++) {\n            //     child.children.push({\n            //         base: childNodes[i],\n            //     });\n            // }\n\n        }\n    } else if (name[0] === \"o\" && name[1] === \"n\") {\n        const oldName = name;\n        name = name.replace(/Capture$/, \"\");\n        const useCapture = oldName !== name;\n        name = name.toLowerCase().substring(2);\n        if (value) {\n            if (!old) {\n                addEventListener(node, name, useCapture, child);\n            }\n        } else {\n            removeEventListener(node, name, useCapture, child);\n        }\n        if (!child._listeners) {\n            child._listeners = {};\n        }\n        child._listeners[name] = value;\n    } else if (name !== \"list\" && name !== \"type\" && !isSvg && name in node) {\n        setProperty(node, name, value == null ? \"\" : value);\n        if (value == null || value === false) {\n            node.removeAttribute(name);\n        }\n    } else {\n        const ns = isSvg && (name !== (name = name.replace(/^xlink\\:?/, \"\")));\n        // null || undefined || void 0 || false\n        if (value == null || value === false) {\n            if (ns) {\n                node.removeAttributeNS(\n                    \"http://www.w3.org/1999/xlink\",\n                    name.toLowerCase(),\n                );\n            } else {\n                node.removeAttribute(name);\n            }\n        } else if (typeof value !== \"function\") {\n            if (ns) {\n                node.setAttributeNS(\n                    \"http://www.w3.org/1999/xlink\",\n                    name.toLowerCase(),\n                    value,\n                );\n            } else {\n                node.setAttribute(name, value);\n            }\n        }\n    }\n}\n\nfunction setProperty(node: any, name: string, value: string) {\n    try {\n        node[name] = value;\n    } catch (e) { }\n}\n\nfunction eventProxy(child: any): (e: Event) => void {\n    return (e: Event) => {\n        const listener = child._listeners[e.type];\n        const event = options.event && options.event(e) || e;\n        if (options.eventBind) {\n            return listener.call(child._component, event);\n        }\n        return listener(event);\n    };\n}\n\nexport function getPreviousSibling(node: Node): Node| null {\n    return node.previousSibling;\n}\n\nexport function getLastChild(node: Node): Node| null {\n    return node.lastChild;\n}\n\nexport function isTextNode(node: Text | any): boolean {\n    return node.splitText !== undefined;\n}\n\nfunction addEventListener(node: any, name: string, useCapture: boolean, child: any) {\n    const eventProxyFun = eventProxy(child);\n    if (!child.event) {\n        child.event = {};\n    }\n    child.event[name] = eventProxyFun;\n    if (node.addEventListener) {\n        node.addEventListener(name, eventProxyFun, useCapture);\n    } else {\n        node.attachEvent(\"on\" + name, eventProxyFun);\n    }\n}\n\nfunction removeEventListener(node: any, name: string, useCapture: boolean, child: any) {\n    const eventProxyFun = child.event[name];\n    if (node.removeEventListener) {\n        node.removeEventListener(name, eventProxyFun, useCapture);\n    } else {\n        node.detachEvent(\"on\" + name, eventProxyFun);\n    }\n}\n","import { VNode } from \"../vnode\";\nimport { Component } from \"../component\";\nimport { isTextNode } from \"../dom/index\";\nimport { ATTR_KEY } from \"../constants\";\nimport { extend } from \"../util\";\n\nexport function isSameNodeType(node: any, vnode: VNode, hydrating: boolean) {\n    if (typeof vnode === \"string\" || typeof vnode === \"number\") {\n        return isTextNode(node.base);\n    }\n    if (typeof vnode.nodeName === \"string\") {\n        return !node._componentConstructor && isNamedNode(node.base, vnode.nodeName);\n    }\n    return hydrating || node._componentConstructor === vnode.nodeName;\n}\n\n/** Check if an Element has a given normalized name.\n * @param {Element} node\n * @param {String} nodeName\n */\nexport function isNamedNode(\n    node: { normalizedNodeName: string, nodeName: string },\n    nodeName: string,\n) {\n    return node.normalizedNodeName === nodeName\n        || node.nodeName.toLowerCase() === nodeName.toLowerCase();\n}\n\nexport function getNodeProps(vnode: VNode) {\n    const props = extend({}, vnode.attributes);\n    props.children = vnode.children;\n    const nodeName: any = vnode.nodeName;\n    const defaultProps = nodeName.defaultProps;\n    if (defaultProps !== undefined) {\n        for (const i in defaultProps) {\n            if (props[i] === undefined) {\n                props[i] = defaultProps[i];\n            }\n        }\n    }\n    return props;\n}\n\ninterface IKeyValue {\n    [name: string]: any;\n}\ninterface IEventFunList {\n    [name: string]: Array<(e: Event) => void>;\n}\n\n/**\n * 真正dom绑定的一些数据\n * @constructor\n */\nexport class VDom {\n    /**\n     * dom所属的顶级Component\n     */\n    public component?: Component;\n    /**\n     * 子组件\n     */\n    public children?: VDom[];\n    /**\n     * 真实dom索引\n     */\n    public base?: Element;\n    /**\n     * 每种事件的代理方法存放点, 真实绑定到dom上的方法。\n     */\n    public eventProxy?: { [name: string]: (e: Event) => void };\n    /**\n     * dom所属的props\n     */\n    public props?: IKeyValue;\n    /**\n     * 通过props设置的事件方法, 通过eventProxy来调用, 保证在不停的props变化时不会一直绑定与解绑。\n     */\n    public listeners?: IEventFunList;\n    /**\n     * domb标签名\n     */\n    public normalizedNodeName?: string;\n}\n","import { ATTR_KEY } from \"../constants\";\nimport { isSameNodeType, isNamedNode } from \"./index\";\nimport { buildComponentFromVNode, unmountComponent, removeDomChild } from \"./component\";\nimport {\n    setAccessor,\n    createNode,\n    removeNode,\n    getPreviousSibling,\n    getLastChild,\n    isTextNode,\n} from \"../dom/index\";\nimport options from \"../options\";\nimport { VNode } from \"../vnode\";\nimport { Component } from \"../component\";\n\nexport const mounts: Component[] = [];\n\nexport let diffLevel = 0;\n\nlet isSvgMode = false;\n\nlet hydrating = false;\n\nexport function flushMounts() {\n    let c = mounts.pop();\n    while (c) {\n        const afterMount = options.afterMount;\n        if (afterMount) {\n            afterMount(c);\n        }\n        if (c.componentDidMount) {\n            c.componentDidMount();\n        }\n        c = mounts.pop();\n    }\n}\n\n/**\n * 比较dom差异\n * @param dom 原dom\n * @param vnode jsx\n * @param context 通过render来的是一个空对象。\n * @param mountAll 是否已全部挂载\n * @param parent 挂载元素\n * @param componentRoot 是否为componentRoot\n */\nexport function diff(\n    dom: Element | undefined,\n    vnode: VNode | void,\n    context: any,\n    mountAll: boolean,\n    parent: any,\n    componentRoot: boolean,\n    child: any,\n): Element {\n    if (child.base && dom !== child.base) {\n        // 原preact使用dom存放数据，现在，如果dom不存在，且pchild内有dom就卸载掉\n        removeDomChild(child);\n    }\n    if (!diffLevel++) {\n        // 在diff调用递归层数为0时设置isSvgMode，hydrating\n        isSvgMode = parent != null && parent.ownerSVGDocument !== undefined;\n        hydrating = dom != null && !(child && child[ATTR_KEY]);\n    }\n    // 调用idiff生成dom\n    const ret = idiff(\n        dom,\n        vnode,\n        context,\n        mountAll,\n        componentRoot,\n        child,\n    );\n    // 如果有父dom直接appendChild\n    if (parent && ret.parentNode !== parent) {\n        parent.appendChild(ret);\n    }\n    if (!--diffLevel) {\n        // diff调用递归层为0\n        hydrating = false;\n        if (!componentRoot) {\n            flushMounts();\n        }\n    }\n    return ret;\n}\n\nfunction idiff(\n    dom: any,\n    vnode: any,\n    context: any,\n    mountAll: boolean,\n    componentRoot?: boolean,\n    child?: any,\n) {\n    // if (child.base && dom !== child.base) {\n    //     // 原preact使用dom存放数据，现在，如果dom不存在，且pchild内有dom就卸载掉\n    //     removeDomChild(child);\n    // }\n    let out = dom;\n    const prevSvgMode = isSvgMode;\n\n    if (vnode == null || typeof vnode === \"boolean\") {\n        vnode = \"\";\n    }\n    if (typeof vnode === \"string\" || typeof vnode === \"number\") {\n        if (\n            dom\n            && isTextNode(dom)\n            && dom.parentNode\n            && (!child._component || componentRoot)\n        ) {\n            if (dom.nodeValue !== vnode) {\n                dom.nodeValue = vnode;\n            }\n        } else {\n            const data: any = vnode;\n            out = document.createTextNode(data);\n            if (dom) {\n                if (dom.parentNode) {\n                    dom.parentNode.replaceChild(out, dom);\n                }\n                // if (child.base !== dom) {\n                //     child.base = dom;\n                // }\n                recollectNodeTree(child, true);\n            }\n        }\n        child[ATTR_KEY] = true;\n        child.base = out;\n        return out;\n    }\n    let vnodeName = vnode.nodeName;\n    if (typeof vnodeName === \"function\") {\n        return buildComponentFromVNode(dom, vnode, context, mountAll, child);\n    }\n\n    isSvgMode = vnodeName === \"svg\"\n        ? true : vnodeName === \"foreignObject\" ? false : isSvgMode;\n    vnodeName = String(vnodeName);\n    if (!dom || !isNamedNode(dom, vnodeName)) {\n        out = createNode(vnodeName, isSvgMode);\n        if (dom) {\n            while (dom.firstChild) {\n                out.appendChild(dom.firstChild);\n            }\n            if (dom.parentNode) {\n                dom.parentNode.replaceChild(out, dom);\n            }\n            // if (child.base !== dom) {\n            //     child.base = dom;\n            // }\n            recollectNodeTree(child, true);\n        }\n    }\n    const fc = out.firstChild;\n    let props = child[ATTR_KEY];\n    const vchildren = vnode.children;\n    if (props == null) {\n        props = child[ATTR_KEY] = {};\n        for (let a = out.attributes, i = a.length; i-- ; ) {\n            const attr = a[i];\n            props[attr.name] = attr.value;\n        }\n    }\n\n    if (child.base !== out) {\n        child.base = out;\n    }\n    if (\n        !hydrating\n        && vchildren\n        && vchildren.length === 1\n        && typeof vchildren[0] === \"string\"\n        && fc != null\n        && isTextNode(fc)\n        && fc.nextSibling == null\n    ) {\n        if (fc.nodeValue !== vchildren[0]) {\n            fc.nodeValue = vchildren[0];\n        }\n    } else if (vchildren && vchildren.length || fc != null) {\n        if (!child.children) {\n            child.children = [];\n        }\n        innerDiffNode(\n            out,\n            vchildren,\n            context,\n            mountAll,\n            hydrating || props.dangerouslySetInnerHTML != null,\n            child,\n        );\n    }\n\n    diffAttributes(out, vnode.attributes, props, child);\n    isSvgMode = prevSvgMode;\n    return out;\n}\n\nfunction innerDiffNode(\n    dom: Node,\n    vchildren: any[],\n    context: any,\n    mountAll: boolean,\n    isHydrating: boolean,\n    domChild: any,\n) {\n    let originalChildren = domChild.children;\n    const children = [];\n    const keyed: {\n        [name: string]: any;\n    } = {};\n    let keyedLen = 0;\n    let min = 0;\n    let childrenLen = 0;\n    const vlen = vchildren ? vchildren.length : 0;\n    let j;\n    let c;\n    let f;\n    let vchild;\n    let child;\n    const pchildren = [];\n    const childNodes = dom.childNodes;\n    const unChildren = [];\n\n    if (childNodes.length !== originalChildren.length) {\n        let offset = 0;\n        const nodeList = childNodes;\n        const nodeLen = nodeList.length;\n        const newChildren = [];\n        for (let i = 0; i < nodeLen; i++) {\n            const node = nodeList[i];\n            let vdom = originalChildren[i + offset];\n            while (vdom && node !== vdom.base) {\n                offset ++;\n                vdom = originalChildren[i + offset];\n            }\n            if (vdom) {\n                newChildren.push(vdom);\n            } else {\n                newChildren.push({\n                    base: node,\n                });\n            }\n        }\n        originalChildren = newChildren;\n    }\n    const len = originalChildren.length;\n    // Build up a map of keyed children and an Array of unkeyed children:\n    if (len !== 0) {\n    for (let i = 0; i < len; i++) {\n        const pchild: any = originalChildren[i];\n        const props = pchild[ATTR_KEY];\n        const key = vlen && props\n            ? pchild._component\n                ? pchild._component.__key\n                : props.key\n            : null;\n        if (key != null) {\n            keyedLen++;\n            keyed[key] = pchild;\n        } else if (\n            props\n            || (\n                isTextNode(pchild.base)\n                ? (isHydrating ? pchild.base.nodeValue.trim() : true)\n                : isHydrating\n            )\n            ) {\n            children[childrenLen++] = pchild;\n        }\n    }\n    }\n\n    if (vlen !== 0) {\n        for (let i = 0; i < vlen; i++) {\n            vchild = vchildren[i];\n            child = null;\n            let tchild = null;\n            // attempt to find a node based on key matching\n            const key = vchild.key;\n            if (key != null) {\n                if (keyedLen && keyed[key] !== undefined) {\n                    child = keyed[key];\n                    keyed[key] = undefined;\n                    keyedLen--;\n                }\n            } else if (!child && min < childrenLen) {\n            // attempt to pluck a node of the same type from the existing children\n                for (j = min; j < childrenLen; j++) {\n                    c = children[j];\n                    if (children[j] !== undefined && isSameNodeType(c, vchild, isHydrating)) {\n                        child = c;\n                        children[j] = undefined;\n                        if (j === childrenLen - 1) {\n                            childrenLen--;\n                        }\n                        if (j === min) {\n                            min++;\n                        }\n                        break;\n                    }\n                }\n            }\n            // 获取上一次的props存储对象\n            tchild = child || {};\n            // morph the matched/found/created DOM child to match vchild (deep)\n            child = idiff(child && child.base, vchild, context, mountAll, false, tchild);\n            // 把新的props存储对象存储起来\n            pchildren.push(tchild);\n            // 获取真实\n            f = childNodes[i];\n            if (child && child !== dom && child !== f) {\n                if (f == null) {\n                    dom.appendChild(child);\n                } else if (child === f.nextSibling) {\n                    const t: any = f;\n                    removeNode(t);\n                } else {\n                    dom.insertBefore(child, f);\n                }\n            }\n        }\n    }\n    domChild.children = pchildren;\n    // remove unused keyed children:\n    if (keyedLen) {\n        for (const i in keyed) {\n            if (keyed[i] !== undefined) {\n                // removeNode(keyed[i].base);\n                recollectNodeTree(keyed[i], false);\n            }\n        }\n    }\n\n    // remove orphaned unkeyed children:\n    while (min <= childrenLen) {\n        child = children[childrenLen--];\n        if (child !== undefined) {\n            // removeNode(child.base);\n            recollectNodeTree(child, false);\n        }\n    }\n}\n/** 递归回收(或者只是卸载一个)\n * @param node 要被卸载的dom\n * @param unmountOnly 为true则只触发生命周期，跳过删除(仅在dom上的组件索引不存在有效)\n */\nexport function recollectNodeTree(node: any, unmountOnly: any) {\n    // 获取dom上的组件索引\n    const component = node._component;\n    if (component) {\n        // 如果存在\n        unmountComponent(component);\n        node._component = null;\n        removeDomChild(node);\n    } else {\n        if (node[ATTR_KEY] != null && node[ATTR_KEY].ref) {\n            // ref用于取消引用dom\n            node[ATTR_KEY].ref(null);\n        }\n        if (unmountOnly === false || node[ATTR_KEY] == null) {\n            // 移除dom\n            removeNode(node.base);\n        }\n        // 卸载子dom\n        removeChildren(node);\n    }\n}\n\nexport function removeChildren(node: any) {\n    // 去除最后一个子元素\n    const nodeList = node.children;\n    node.children = [];\n    let len = nodeList ? nodeList.length : 0;\n    // node = getLastChild(node && node.base);\n    while (len--) {\n        // 不需要移除因为父级已经移除\n        recollectNodeTree(nodeList[len], true);\n    }\n    // removeDomChild\n    removeDomChild(node);\n}\n\nfunction diffAttributes(dom: any, attrs: any, old: any, child: any) {\n    let name: string;\n    for (name in old) {\n        if (!(attrs && attrs[name] != null) && old[name] != null) {\n            const oldValue = old[name];\n            const value = old[name] = undefined;\n            setAccessor(dom, name, oldValue, value, isSvgMode, child);\n        }\n    }\n    for (name in attrs) {\n        if (\n            name !== \"children\"\n            && name !== \"innerHTML\"\n            && (\n                !(name in old)\n                || attrs[name] !== (\n                    name === \"value\"\n                    || name === \"checked\"\n                    ? dom[name]\n                    : old[name]\n                )\n            )\n        ) {\n            const oldValue = old[name];\n            const value = old[name] = attrs[name];\n            setAccessor(dom, name, oldValue, value, isSvgMode, child);\n        }\n    }\n\n}\n","import { enqueueRender } from \"../render-queue\";\nimport { Component } from \"../component\";\nimport { ASYNC_RENDER, ATTR_KEY, FORCE_RENDER, NO_RENDER, SYNC_RENDER } from \"../constants\";\nimport options from \"../options\";\nimport { VNode } from \"../vnode\";\nimport { createComponent, collectComponent } from \"./component-recycler\";\nimport { getNodeProps } from \"./index\";\nimport { removeNode } from \"../dom/index\";\nimport { extend } from \"../util\";\n\nimport { diff, diffLevel, flushMounts, mounts, recollectNodeTree, removeChildren } from \"./diff\";\n\nexport function setComponentProps(component: Component, props: any, opts: any, context: any, mountAll: boolean) {\n    if (component._disable) {\n        return;\n    }\n    component._disable = true;\n    const ref = component._ref = props.ref;\n    if (ref) {\n        delete props.ref;\n    }\n    const key = component._key = props.key;\n    if (key) {\n        delete props.key;\n    }\n    if (!component.base || mountAll) {\n        if (component.componentWillMount) {\n            component.componentWillMount();\n        }\n    } else if (component.componentWillReceiveProps) {\n        component.componentWillReceiveProps(props, context);\n    }\n    if (context && context !== component.context) {\n        if (!component.prevContext) {\n            component.prevContext = component.context;\n        }\n        component.context = context;\n    }\n\n    if (!component.prevProps) {\n        component.prevProps = component.props;\n    }\n    component.props = props;\n    component._disable = false;\n    if (opts !== NO_RENDER) {\n        if (\n            opts === SYNC_RENDER\n            || options.syncComponentUpdates !== false\n            || !component.base\n        ) {\n            renderComponent(component, SYNC_RENDER, mountAll);\n        } else {\n            enqueueRender(component);\n        }\n    }\n    if (component._ref) {\n        component._ref(component);\n    }\n}\n\n/**\n * 执行render，diff或新建render\n * @param {Component} component\n * @param {number?} opts\n * @param {boolean?} mountALL\n * @param {boolean?} isChild\n */\nexport function renderComponent(component: Component, opts?: number, mountALL?: boolean, isChild?: boolean): void {\n    if (component._disable) {\n        // 组件已停用直接不做操作。\n        return;\n    }\n    // 获取组件props\n    const props = component.props;\n    // 获取组件state\n    const state = component.state;\n    // 获取组件context\n    let context = component.context;\n    // 获取组件上一次的props没有取当前\n    const previousProps = component.prevProps || props;\n    // 获取组件上一次的state没有取当前\n    const previousState = component.prevState || state;\n    // 获取组件上一次的context没有取当前\n    const previousContext = component.prevContext || context;\n    // 判断是否已有dom元素\n    const isUpdate = component.base;\n    // 被移除过时保存的dom\n    const nextBase = component.nextBase;\n    const initialBase = isUpdate || nextBase;\n    // 获取当前组件的子组件\n    const initialChildComponent = component._component;\n    // 略过dom更新标记\n    let skip = false;\n    let cbase: Element | undefined;\n    if (isUpdate) {\n        // 有dom元素在组件上说明是更新操作.\n        // 把组件上的props，state，context都返回到更新前\n        component.props = previousProps;\n        component.state = previousState;\n        component.context = previousContext;\n        if (opts !== FORCE_RENDER\n            && component.shouldComponentUpdate\n            && component.shouldComponentUpdate(props, state, context) === false\n        ) {\n            // 非用户代码调用(Component.forceUpdate),就执行shouldComponentUpdate钩子\n            // 也就是说如果使用Component.forceUpdate来更新render执行就无法被阻止\n            // shouldComponentUpdate钩子把新的props,state,context作为参数传入\n            // 如果shouldComponentUpdate钩子返回false，跳过下面的dom操作。\n            skip = true;\n        } else if (component.componentWillUpdate) {\n            // render 前钩子与shouldComponentUpdate互斥, Component.forceUpdate更新依旧会触发该钩子。\n            component.componentWillUpdate(props, state, context);\n        }\n        // 把组件上的props，state，context都设置到新的\n        component.props = props;\n        component.state = state;\n        component.context = context;\n    }\n    // 清理掉\n    component.prevProps = null;\n    component.prevState = null;\n    component.prevContext = null;\n    component.nextBase = undefined;\n    // 重置_dirty\n    component._dirty = false;\n\n    if (!skip) {\n        // 当前组件的render函数返回的VNode\n        const rendered: VNode | void = component.render(props, state, context);\n        //\n        let inst: Component | undefined;\n        if (component.getChildContext) {\n            context = extend(context, component.getChildContext());\n        }\n        // 取出VNode的nodeName\n        const childComponent = rendered && rendered.nodeName;\n        let toUnmount: Component | undefined;\n        let base: Element | undefined;\n\n        if (typeof childComponent === \"function\" && rendered) {\n            // 如果是自定义组件\n\n            // if (component.child) {\n            //     component.child = undefined;\n            // }\n            // 获取VNode上的props\n            const childProps = getNodeProps(rendered);\n            inst = initialChildComponent;\n            if (inst && inst.constructor === childComponent && childProps.key === inst._key) {\n                // 子组件已存在且key未变化只改变props\n                setComponentProps(inst, childProps, SYNC_RENDER, context, false);\n            } else {\n                if (inst) {\n                    // 设置到toUnmount等待unmount\n                    toUnmount = inst;\n                    toUnmount.child = extend({}, toUnmount.child);\n                    // 防止共享子dom\n                    inst.child.children = [];\n                }\n                // 新建Component\n                inst = createComponent(childComponent, childProps, context);\n                // 子组件索引保证下次相同子组件不会重新创建\n                component._component = inst;\n                // 设置好缓存dom\n                inst.nextBase = inst.nextBase || nextBase;\n                // 设置父组件索引\n                inst._parentComponent = component;\n                // 设置domchild\n                inst.child = component.child;\n                // 设置props但是不进行render\n                setComponentProps(inst, childProps, NO_RENDER, context, false);\n                // 递归调用renderComponent保证子组件的子组件创建\n                renderComponent(inst, SYNC_RENDER, mountALL, true);\n            }\n            // 把子组件dom设置到base\n            base = inst.base;\n        } else {\n            // 原生组件\n            // 获取原dom或缓存dom\n            cbase = initialBase;\n            // 把自定义子组件放到卸载，对应使用if分支控制自定义组件和原生组件\n            toUnmount = initialChildComponent;\n            if (toUnmount) {\n                // 如果存在说明上次渲染时是一个自定义组件\n                // 清理子组件索引\n                component._component = undefined;\n                // 清理dom索引\n                cbase = undefined;\n            }\n\n            if (initialBase || opts === SYNC_RENDER) {\n                // 组件dom，缓存dom，同步渲染\n                if (component.child && component.child._component) {\n                    // 清理component索引防止使用同一个component情况下却卸载了。\n                    component.child._component = undefined;\n                    //\n                    // const b: any = cbase;\n                    // b._component = undefined;\n                }\n                if (!component.child) {\n                    component.child = {};\n                }\n                // 渲染原生组件\n                base = diff(\n                    // 原dom\n                    cbase,\n                    // VNode\n                    rendered,\n                    context,\n                    // 父级组件需要挂载，或者dom不存在也需要挂载\n                    mountALL || !isUpdate,\n                    // 把组件挂载到缓存dom的父级\n                    initialBase && initialBase.parentNode,\n                    // 以原生组件这里执行说明是自定义组件的第一个原生组件\n                    true,\n                    component.child,\n                );\n            }\n        }\n\n        if (initialBase && base !== initialBase && inst !== initialChildComponent) {\n            // 存在缓存dom，现dom和缓存dom不相同且新建过自定义子组件\n            // 获取当前组件缓存dom的父级dom\n            const baseParent = initialBase.parentNode;\n            if (base && baseParent && base !== baseParent) {\n                // 替换到新dom\n                baseParent.replaceChild(base, initialBase);\n                if (!toUnmount) {\n                    // 没有\n                    // const initBase: any = initialBase;\n                    // 去除dom上的component索引\n                    // initBase._component = null;\n                    component.child.base = initialBase;\n                    component.child._component = null;\n                    recollectNodeTree(component.child, false);\n                    component.child.base = null;\n                }\n            }\n        }\n        if (toUnmount) {\n            unmountComponent(toUnmount);\n        }\n\n        component.base = base;\n        if (base && !isChild) {\n            let componentRef: Component | undefined = component;\n            let t: Component | undefined = component;\n            while ((t = t._parentComponent)) {\n                componentRef = t;\n                componentRef.base = base;\n            }\n            // const _base: any = base;\n            // try {\n            //     _base._component = componentRef;\n            //     _base._componentConstructor = componentRef.constructor;\n            // } catch (e) {}\n            component.child._component = componentRef;\n            component.child._componentConstructor = componentRef.constructor;\n            // component.child.base = base;\n        }\n    }\n    if (!isUpdate || mountALL) {\n        mounts.unshift(component);\n    } else if (!skip) {\n        if (component.componentDidUpdate) {\n            component.componentDidUpdate(previousProps, previousState, previousContext);\n        }\n        if (options.afterUpdate) {\n            options.afterUpdate(component);\n        }\n    }\n\n    if (component._renderCallbacks != null) {\n        while (component._renderCallbacks.length) {\n            component._renderCallbacks.pop().call(component);\n        }\n    }\n    if (!diffLevel && !isChild) {\n        flushMounts();\n    }\n}\n\nexport function buildComponentFromVNode(\n    dom: any,\n    vnode: VNode,\n    context: any,\n    mountALL: boolean,\n    child: any,\n) {\n    let c = child && child._component;\n    const originalComponent = c;\n    let oldDom = dom;\n    const isDiectOwner = c && child._componentConstructor === vnode.nodeName;\n    let isOwner = isDiectOwner;\n    const props = getNodeProps(vnode);\n    while (c && !isOwner && (c = c._parentComponent)) {\n        isOwner = c.constructor === vnode.nodeName;\n    }\n\n    if (c && isOwner && (!mountALL || c._component)) {\n        setComponentProps(c, props, ASYNC_RENDER, context, mountALL);\n        dom = c.base;\n    } else {\n        if (originalComponent && !isDiectOwner) {\n            unmountComponent(originalComponent);\n            dom = oldDom = null;\n        }\n\n        c = createComponent(vnode.nodeName, props, context);\n        if (dom && !c.nextBase) {\n            c.nextBase = dom;\n            oldDom = null;\n        }\n        c.child = child;\n        // child._component = c;\n        setComponentProps(\n            c,\n            props,\n            SYNC_RENDER,\n            context,\n            mountALL,\n        );\n        dom = c.base;\n        if (oldDom && dom !== oldDom) {\n            // oldDom._component = null;\n            recollectNodeTree(oldDom, false);\n        }\n    }\n    return dom;\n}\n\nexport function unmountComponent(component: Component) {\n    if (options.beforeUnmount) {\n        options.beforeUnmount(component);\n    }\n    const base = component.base;\n    component._disable = true;\n    if (component.componentWillUnmount) {\n        component.componentWillUnmount();\n    }\n    component.base = undefined;\n    const inner = component._component;\n    const anyBase: any = base;\n    if (inner) {\n        unmountComponent(inner);\n    } else if (anyBase && component.child) {\n        if (component.child[ATTR_KEY] && component.child[ATTR_KEY].ref) {\n            component.child[ATTR_KEY].ref(null);\n        }\n        // 卸载组件dom前把它存到nextBase\n        component.nextBase = anyBase;\n        // 从dom上移除\n        removeNode(anyBase);\n        // 放入全局缓存对象保存\n        collectComponent(component);\n        removeChildren(component.child);\n    }\n    if (component._ref) {\n        component._ref(null);\n    }\n}\n\nexport function removeDomChild(child: any) {\n    child.base = null;\n    child._component = null;\n    child[ATTR_KEY] = null;\n    child.event = null;\n    child._listeners = null;\n    child._componentConstructor = null;\n    child.children = [];\n}\n","import { FORCE_RENDER } from \"./constants\";\nimport { renderComponent } from \"./vdom/component\";\nimport { VNode } from \"./vnode\";\nimport { enqueueRender } from \"./render-queue\";\nimport { extend } from \"./util\";\n\nexport class Component {\n    // 当前组件的状态,可以修改\n    public state: any;\n    // 由父级组件传递的状态，不可修改\n    public props: any;\n    public context: any;\n    // 默认props\n    public defaultProps?: any;\n    // 组件挂载后的dom\n    public base?: Element;\n    // 自定义组件名\n    public name?: string;\n    // 修改状态时的原状态\n    public prevProps?: any;\n    public prevState?: any;\n    public prevContext?: any;\n    // 被移除时的dom缓存\n    public nextBase?: Element;\n    /**\n     * 在一个组件被渲染到 DOM 之前\n     */\n    public componentWillMount?: () => void;\n    /**\n     * 在一个组件被渲染到 DOM 之后\n     */\n    public componentDidMount?: () => void;\n    /**\n     * 在一个组件在 DOM 中被清除之前\n     */\n    public componentWillUnmount?: () => void;\n    /**\n     * 在新的 props 被接受之前\n     * @param { any } nextProps\n     * @param { any } nextContext\n     */\n    public componentWillReceiveProps?: (nextProps: any, nextContext: any) => void;\n    /**\n     * 在 render() 之前. 若返回 false，则跳过 render，与 componentWillUpdate 互斥\n     * @param { any } nextProps\n     * @param { any } nextState\n     * @param { any } nextContext\n     * @returns { boolean }\n     */\n    public shouldComponentUpdate?: (nextProps: any, nextState: any, nextContext: any) => boolean;\n    /**\n     * 在 render() 之前，与 shouldComponentUpdate 互斥\n     * @param { any } nextProps\n     * @param { any } nextState\n     * @param { any } nextContext\n     */\n    public componentWillUpdate?: (nextProps: any, nextState: any, nextContext: any) => void;\n    /**\n     * 在 render() 之后\n     * @param { any } previousProps\n     * @param { any } previousState\n     * @param { any } previousContext\n     */\n    public componentDidUpdate?: (previousProps: any, previousState: any, previousContext: any) => void;\n    public getChildContext?: () => any;\n    public _component?: Component;\n    public _parentComponent?: Component;\n    // 能否添加入更新队列\n    public _dirty: boolean;\n    // render 执行完后的回调队列\n    public _renderCallbacks?: any[];\n    public _key?: string;\n    // 是否停用\n    public _disable?: boolean;\n    public _ref?: (component: Component | null) => void;\n    // 原生如果VNode，root为原生组件就创建并设置它的一些props，event\n    public child?: any;\n    constructor(props: any, context: any) {\n        // 初始化为true\n        this._dirty = true;\n        this.context = context;\n        this.props = props;\n        this.state = this.state || {};\n    }\n    /**\n     * 设置state并通过enqueueRender异步更新dom\n     * @param state 对象或方法\n     * @param callback render执行完后的回调。\n     */\n    public setState(state: any, callback?: () => void): void {\n        const s: any = this.state;\n        if (!this.prevState) {\n            // 把旧的状态保存起来\n            this.prevState = extend({}, s);\n        }\n        if (typeof state === \"function\") {\n            const newState = state(s, this.props);\n            if (newState) {\n                extend(s, newState);\n            }\n        } else {\n            extend(s, state);\n        }\n        if (callback) {\n            // 添加回调\n            this._renderCallbacks = this._renderCallbacks || [];\n            this._renderCallbacks.push(callback);\n        }\n        // 更新dom\n        enqueueRender(this);\n    }\n    /**\n     * 手动的同步更新dom\n     * @param callback 回调\n     */\n    public forceUpdate(callback: () => void) {\n        if (callback) {\n            this._renderCallbacks = this._renderCallbacks || [];\n            this._renderCallbacks.push(callback);\n        }\n        renderComponent(this, FORCE_RENDER);\n    }\n    /**\n     * 用来生成VNode的函数，一定要继承后覆盖\n     * @param props\n     * @param state\n     * @param context\n     */\n    public render(props: any, state?: any, context?: any): VNode | void {\n        // console.error(\"not set render\");\n    }\n}\n","import { Component } from \"./component\";\n\n/**\n * 简单组件state,props对象只有一层改变使用，超过一层改变就会无法更新\n * @constructor\n */\nexport class PureComponent extends Component {\n    public isPureReactComponent: boolean = true;\n    public shouldComponentUpdate(props: any, state: any): boolean {\n        // props,state只要一个不同就返回true\n        return shallowDiffers(this.props, props) || shallowDiffers(this.state, state);\n    }\n}\n\n/**\n * 判断两对象的属性值不同\n * @param a\n * @param b\n */\nfunction shallowDiffers(a: any, b: any): boolean {\n    for (const i in a) {\n        if (!(i in b)) {\n            return true;\n        }\n    }\n    for (const i in b) {\n        if (a[i] !== b[i]) {\n            return true;\n        }\n    }\n    return false;\n}\n","import { diff } from \"./vdom/diff\";\nimport { VNode } from \"./vnode\";\n\nconst child = {};\n\n/**\n * 创建组件到dom上\n * @param vnode jsx\n * @param parent 挂载的dom元素\n * @param merge 原dom元素\n */\nexport function render(vnode: VNode, parent: Element, merge: Element, domChild?: any) {\n    const pchild = domChild || child;\n    const base: any = diff(merge, vnode, {}, false, parent, false, pchild);\n    if (pchild._component) {\n        base._component = pchild._component;\n    }\n    return base;\n}\n","import { Component } from \"./component\";\nimport { extend } from \"./util\";\n\nexport function createClass(obj: any) {\n    const cl: any = function(props: any, context: any) {\n        Component.call(this, props, context, {});\n    };\n    obj = extend({ constructor: cl }, obj);\n    if (obj.defaultProps) {\n        cl.defaultProps = obj.defaultProps;\n    }\n    F.prototype = Component.prototype;\n    cl.prototype = extend(new F(), obj);\n\n    cl.displayName = obj.displayName || \"Component\";\n    return cl;\n}\n\nclass F {\n}\n","import { h, h as createElement } from \"./h\";\nimport { cloneElement } from \"./clone-element\";\nimport { Component } from \"./component\";\nimport { PureComponent } from \"./pure-component\";\nimport { render } from \"./render\";\nimport options from \"./options\";\nimport { createClass } from \"./create-class\";\nimport { rerender } from \"./render-queue\";\n\nexport default {\n    Component,\n    PureComponent,\n    cloneElement,\n    createClass,\n    createElement,\n    h,\n    options,\n    render,\n    rerender,\n};\n\nexport {\n    Component,\n    PureComponent,\n    cloneElement,\n    createClass,\n    createElement,\n    h,\n    options,\n    render,\n    rerender,\n};\n"],"names":[],"mappings":"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"}