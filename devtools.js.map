{"version":3,"file":"devtools.js","sources":["src/util.ts","src/devtools.ts","src/devtools-run.ts"],"sourcesContent":["declare const Promise: any;\ndeclare class Object {\n    public static assign: (...args: any[]) => any;\n}\n\n/**\n * 异步调度方法，异步的执行传入的方法\n */\nexport let defer: (fn: () => void) => void;\nif (typeof Promise === \"function\") {\n    const promiseDefer = Promise.resolve();\n    defer = (fn: () => void) => promiseDefer.then(fn);\n} else {\n    defer = setTimeout;\n}\n\n/**\n * Object.assign的兼容\n */\nexport const extend = Object.assign || function assign_(t: any) {\n    for (let s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (const p in s) {\n            if (Object.prototype.hasOwnProperty.call(s, p)) {\n                t[p] = s[p];\n            }\n        }\n    }\n    return t;\n};\n","import { options, Component} from \"zreact\";\nimport { IKeyValue } from \"./types\";\nimport { VDom } from \"./vdom/index\";\nimport { extend } from \"./util\";\n\ninterface IReactElement {\n    props?: boolean|IKeyValue;\n    type: any;\n    ref?: ((c: Component|null) => void)|null;\n    key?: string;\n}\ninterface IReactComponent {\n    _currentElement: IReactElement|string|null;\n    node?: Text|Element|Node;\n    _instance?: Component;\n    _renderedComponent?: IReactComponent;\n    forceUpdate?: () => void;\n    getName?: () => void;\n    props?: IKeyValue;\n    setState?: () => void;\n    state?: IKeyValue;\n    _inDevTools?: boolean;\n    _renderedChildren?: IReactComponent[];\n    _stringText?: null|string;\n    _rootID?: string;\n    _component?: any;\n}\n\ndeclare const window: {\n    $zreact: VDom,\n    __REACT_DEVTOOLS_GLOBAL_HOOK__?: any,\n};\n\ndeclare class Map {\n    public has(key: any): boolean;\n    public get(key: any): any;\n    public set(key: any, val: any): void;\n    public delete(key: any): void;\n}\n\n/**\n * 将zreact的component实例转换为React的\n * @param  component\n */\nfunction createReactElement(component: Component): IReactElement {\n    const element: IReactElement = {\n        key: component._key,\n        props: component.props,\n        ref: null, // Unsupported\n        type: component.constructor,\n    };\n    return element;\n}\n\n/**\n * 获取组件名\n * @param  element\n */\nfunction typeName(element: IReactElement): string {\n    if (typeof element.type === \"function\") {\n        return element.type.displayName || element.type.name;\n    }\n    return element.type;\n}\n/**\n * 将component转换实例\n * @param component\n */\nfunction createReactCompositeComponent(component: Component): IReactComponent {\n    const _currentElement = createReactElement(component);\n    const node = component.vdom && component.vdom.base;\n    const instance: IReactComponent = {\n        _currentElement,\n        _instance: component,\n        forceUpdate: component.forceUpdate && component.forceUpdate.bind(component),\n        getName: function getName() {\n            return typeName(_currentElement);\n        },\n        node,\n        props: component.props,\n        setState: component.setState && component.setState.bind(component),\n        state: component.state,\n    };\n    if (component._component) {\n        instance._renderedComponent = updateReactComponent(component._component);\n    } else if (component.vdom) {\n        instance._renderedComponent = updateReactComponent(component.vdom);\n    }\n    return instance;\n}\n\n/**\n * 将vdom转换为实例\n * @param vdom\n */\nfunction createReactDOMComponent(vdom: VDom): IReactComponent {\n    const node = vdom.base;\n    const childVDom = vdom.children ? vdom.children : [];\n    const isText = node.nodeType === Node.TEXT_NODE;\n    let element: string|IReactElement|null;\n    if (isText) {\n        element = node.textContent;\n    } else {\n        element = {\n            props: vdom.props,\n            type: node.nodeName.toLowerCase(),\n        };\n    }\n    return {\n        _currentElement: element,\n        _inDevTools: false,\n        _renderedChildren: childVDom.map(function _(child) {\n            if (child.component) {\n                return updateReactComponent(child.component);\n            }\n            return updateReactComponent(child);\n        }),\n        _stringText: isText ? node.textContent : null,\n        node,\n    };\n}\nconst instanceMap = new Map();\n/**\n * 将vdom或component转换为实例\n * @param componentOrVDom\n */\nfunction updateReactComponent(componentOrVDom: any): IReactComponent {\n    const isVDom = componentOrVDom.base != null;\n    const newInstance = isVDom ? createReactDOMComponent(componentOrVDom) : createReactCompositeComponent(componentOrVDom);\n    const base = isVDom ? componentOrVDom.base : componentOrVDom;\n    if (instanceMap.has(base)) {\n        const inst = instanceMap.get(base);\n        extend(inst, newInstance);\n        return inst;\n    }\n    instanceMap.set(base, newInstance);\n    return newInstance;\n}\n\nfunction nextRootKey(roots: IKeyValue) {\n    return \".\" + Object.keys(roots).length;\n}\n\nfunction findRoots(node: Element, roots: IKeyValue) {\n    Array.prototype.forEach.call(node.childNodes, function _(child: any) {\n        if (child._vdom && child._vdom.component) {\n            roots[nextRootKey(roots)] = updateReactComponent(child._vdom.component);\n        } else {\n            findRoots(child, roots);\n        }\n    });\n}\n\nfunction isRootComponent(component: Component) {\n    if (component._parentComponent) {\n        return false;\n    }\n    if (component.vdom && component.vdom.parent && component.vdom.parent.props) {\n        return false;\n    }\n    return true;\n}\n\nfunction visitNonCompositeChildren(component: IReactComponent, visitor: (arg: IReactComponent) => void) {\n    if (component._renderedComponent) {\n        if (!component._renderedComponent._component) {\n            visitor(component._renderedComponent);\n            visitNonCompositeChildren(component._renderedComponent, visitor);\n        }\n    } else if (component._renderedChildren) {\n        component._renderedChildren.forEach(function _(child) {\n            visitor(child);\n            if (!child._component) {\n                visitNonCompositeChildren(child, visitor);\n            }\n        });\n    }\n}\n\nfunction createDevToolsBridge(vdom?: VDom) {\n    const ComponentTree = {\n        getClosestInstanceFromNode: function getClosestInstanceFromNode(node: any) {\n            while (node && !node._vdom) {\n                node = node.parentNode;\n            }\n            return node ? updateReactComponent(node._vdom) : null;\n        },\n        getNodeFromInstance: function getNodeFromInstance(instance: IReactComponent) {\n            return instance.node;\n        },\n    };\n\n    const roots: {\n        [name: string]: IReactComponent;\n    } = {};\n    if (vdom && vdom.component) {\n        roots[\".0\"] = updateReactComponent(vdom.component);\n    } else {\n        if (window.$zreact) {\n            const keys = Object.keys(roots);\n            if (keys.length > 0) {\n                keys.forEach((key) => {\n                    delete roots[key];\n                });\n            }\n            roots[\".0\"] = updateReactComponent(window.$zreact);\n        } else {\n            findRoots(document.body, roots);\n        }\n    }\n    // findRoots(document.body, roots);\n\n    const Mount = {\n        _instancesByReactRootID: roots,\n        _renderNewRootComponent: function _renderNewRootComponent(arg: IReactComponent){},\n    };\n    const Reconciler = {\n        mountComponent: function mountComponent(arg: IReactComponent){},\n        performUpdateIfNecessary: function performUpdateIfNecessary(){},\n        receiveComponent: function receiveComponent(arg: IReactComponent){},\n        unmountComponent: function unmountComponent(arg: IReactComponent){},\n    };\n    const componentAdded = function componentAdded_(component: Component) {\n        const instance = updateReactComponent(component);\n        if (isRootComponent(component)) {\n            instance._rootID = nextRootKey(roots);\n            roots[instance._rootID] = instance;\n            Mount._renderNewRootComponent(instance);\n        }\n        visitNonCompositeChildren(instance, function _(childInst) {\n            childInst._inDevTools = true;\n            Reconciler.mountComponent(childInst);\n        });\n        Reconciler.mountComponent(instance);\n    };\n    const componentUpdated = function componentUpdated_(component: Component) {\n        const prevRenderedChildren: IReactComponent[] = [];\n        visitNonCompositeChildren(instanceMap.get(component), function _(childInst: IReactComponent) {\n            prevRenderedChildren.push(childInst);\n        });\n        const instance = updateReactComponent(component);\n        Reconciler.receiveComponent(instance);\n        visitNonCompositeChildren(instance, function _(childInst: IReactComponent) {\n            if (!childInst._inDevTools) {\n                childInst._inDevTools = true;\n                Reconciler.mountComponent(childInst);\n            } else {\n                Reconciler.receiveComponent(childInst);\n            }\n        });\n        prevRenderedChildren.forEach(function _(childInst: IReactComponent) {\n            if (childInst.node && !document.body.contains(childInst.node)) {\n                instanceMap.delete(childInst.node);\n                Reconciler.unmountComponent(childInst);\n            }\n        });\n    };\n    const componentRemoved = function componentRemoved_(component: Component) {\n        const instance = updateReactComponent(component);\n        visitNonCompositeChildren(instance, function _(childInst) {\n            instanceMap.delete(childInst.node);\n            Reconciler.unmountComponent(childInst);\n        });\n        Reconciler.unmountComponent(instance);\n        instanceMap.delete(component);\n        if (instance._rootID) {\n            delete roots[instance._rootID];\n        }\n    };\n    return {\n        ComponentTree,\n        Mount,\n        Reconciler,\n        componentAdded,\n        componentRemoved,\n        componentUpdated,\n    };\n}\n\nexport function initDevTools(vdom?: VDom) {\n\n    if (typeof window.__REACT_DEVTOOLS_GLOBAL_HOOK__ === \"undefined\") {\n        return;\n    }\n    const bridge = createDevToolsBridge(vdom);\n\n    const nextAfterMount = options.afterMount;\n    options.afterMount = (component: Component) => {\n        bridge.componentAdded(component);\n        if (nextAfterMount) {\n            nextAfterMount(component);\n        }\n    };\n\n    const nextAfterUpdate = options.afterUpdate;\n    options.afterUpdate = (component: Component) => {\n        bridge.componentUpdated(component);\n        if (nextAfterUpdate) {\n            nextAfterUpdate(component);\n        }\n    };\n\n    const nextBeforeUnmount = options.beforeUnmount;\n    options.beforeUnmount = (component: Component) => {\n        bridge.componentRemoved(component);\n        if (nextBeforeUnmount) {\n            nextBeforeUnmount(component);\n        }\n    };\n\n    // Notify devtools about this instance of \"React\"\n    window.__REACT_DEVTOOLS_GLOBAL_HOOK__.inject(bridge);\n\n    return () => {\n        options.afterMount = nextAfterMount;\n        options.afterUpdate = nextAfterUpdate;\n        options.beforeUnmount = nextBeforeUnmount;\n    };\n}\n","import { initDevTools } from \"./devtools\";\n\ninitDevTools();\n"],"names":["options"],"mappings":"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"}